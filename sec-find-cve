#!/bin/bash -eu
#
# Find the given CVE in linux-ubuntu/<series>/linux
#

cve=${1}

while IFS= read -r branch ; do
	match=$(git log --oneline --grep "${cve}$" --max-count=1 "${branch}" -50000 || true)
	if [ -n "${match}" ] ; then
		printf "%-27s -- %s -- %s\n" "${branch}" "${cve}" "${match}"
	else
		printf "%-27s -- %s -- %s\n" "${branch}" "${cve}" "Not found"
	fi
done < <(git branch -r | sed 's/^..//' | grep '^linux-ubuntu/.*/linux$')
